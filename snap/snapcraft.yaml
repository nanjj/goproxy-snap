name: goproxy
version: 0.1.1
grade: stable
summary: A tiny http proxy
description: |
  Goproxy is a tiny http proxy in go
confinement: strict
apps:
  goproxy:
    command: 'bin/goproxy.wrapper'
    plugs: [network-bind, network, content]
    daemon: simple
    stop-timeout: 900s
parts:
  goproxy:
    plugin: go
    source-tag: v0.0.1
    install: |
        mkdir $SNAPCRAFT_PART_INSTALL/bin
        cp -p $SNAPCRAFT_PART_INSTALL/../src/promtool $SNAPCRAFT_PART_INSTALL/bin/
        cp -p $SNAPCRAFT_PART_INSTALL/../src/prometheus $SNAPCRAFT_PART_INSTALL/bin/
  example-config:
    plugin: dump
    source: https://github.com/prometheus/prometheus.git
    source-tag: v1.7.1
    source-type: git
    organize:
      documentation/examples/prometheus.yml: etc/prometheus/prometheus.yml.example
    stage:
      - etc/prometheus/prometheus.yml.example
    prime:
      - etc/prometheus/prometheus.yml.example
  snap-wrappers:
    plugin: dump
    source: .
    organize:
      snap_config_wrapper: bin/prometheus.wrapper
      daemon_arguments: etc/prometheus/daemon_arguments.example
    stage:
      - bin/prometheus.wrapper
      - etc/prometheus/daemon_arguments.example
    prime:
      - bin/prometheus.wrapper
      - etc/prometheus/daemon_arguments.example
